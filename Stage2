install.packages(c("pheatmap", "ggplot2"))

library(pheatmap)

geneExpressionDataset <- 'https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_top_deg_normalized_counts.csv'
samples <- read.csv(geneExpressionDataset, row.names = 1)

head(samples)
View(samples)

#Part a: Heatmap
pheatmap(
  samples,
  scale = "row",  # normalize each gene (row) to mean=0, sd=1
  clustering_distance_rows = "euclidean", #groups gene by similarity
  clustering_distance_cols = "euclidean", #groups samples by similarity
  clustering_method = "complete",
  color = colorRampPalette(brewer.pal(9, "Reds"))(100),
  show_rownames = TRUE,   # shows gene names
  show_colnames = TRUE,   # shows sample names
  fontsize_row = 8,
  fontsize_col = 8,
  main = "Clustered Heatmap of Top DEGs (HBR vs UHR)"
  
)

#Part b: Volcano plot
library(ggplot2)
expressionResultDataset <- 'https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_deg_chr22_with_significance.csv' 
result <- read.csv(expressionResultDataset)

result$log10Padj <- -log10(result$PAdj)

# Up = "up", Down = "down", Not significant = "ns"
result$significance <- factor(result$significance, levels = c("up", "down", "ns"))

# Plot
ggplot(result, aes(x = log2FoldChange, y = log10Padj, color = significance)) +
  geom_point(alpha = 0.7, size = 2) +
  scale_color_manual(values = c("up" = "green", "down" = "orange", "ns" = "grey")) +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "black") +
  labs(
    title = "Volcano Plot of DEGs (HBR vs UHR, Chr22)",
    x = "log2(Fold Change)",
    y = "-log10(Adjusted P-value)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    legend.title = element_blank()
  )



#Stage2 part2
install.packages(c("corrplot"))
library(ggplot2)

breastcancerDataset <- 'https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/data-3.csv'
bc <- read.csv(breastcancerDataset)
#1.
ggplot(bc, aes(x = radius_mean, y = texture_mean, color = diagnosis)) +
  geom_point(alpha = 0.5, size = 3) +
  scale_color_manual(values = c("B" = "blue", "M" = "orange")) +
  labs(
    title = "Texture Mean vs Radius Mean",
    x = "Radius Mean",
    y = "Texture Mean",
    color = "Diagnosis"
  ) +
  theme_minimal()

#2.
library(corrplot)
features <- bc[, c(
  "radius_mean",
  "texture_mean",
  "perimeter_mean",
  "area_mean",
  "smoothness_mean",
  "compactness_mean"
)]

cor_matrix <- cor(features)

corrplot(
  cor_matrix,
  method = "color",
  type = "upper",
  addCoef.col = "black",
  tl.col = "black",
  tl.srt = 90,
  number.cex = 0.8,
  col = colorRampPalette(c("blue", "white", "darkblue"))(200),
  title = "Correlation Heatmap of Breast Cancer Features",
  mar = c(0,0,2,0)
)

#3.
ggplot(bc, aes(x = smoothness_mean , y = compactness_mean, color = diagnosis)) + 
geom_point(alpha = 0.5, size = 3) +
  scale_color_manual(values = c("B" = "blue", "M" = "orange")) +
  labs(
    title = "Compactness Mean vs Smoothness Mean",
    x = "Smoothness Mean",
    y = "Compactness Mean",
    color = "Diagnosis"
  ) +
  theme_minimal() +
  theme(panel.grid.major = element_line(color = "grey80"),
        panel.grid.minor = element_line(color = "grey90"))

#4.
ggplot(bc, aes(x = area_mean, fill = diagnosis)) +
  geom_density(alpha = 0.5) +
  scale_fill_manual(values = c("B" = "orange", "M" = "blue")) +
  labs(
    title = "Density Plot of Area Mean by Diagnosis",
    x = "Area Mean",
    y = "Density",
    fill = "Diagnosis"
  ) +
  theme_minimal()


  

